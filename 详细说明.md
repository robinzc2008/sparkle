# Sparkle/Clash Party åˆ†æµè§„åˆ™è¯´æ˜

æœ¬ä»“åº“ç”¨äºå­˜æ”¾åœ¨ Clash Party / Sparkle ä¸­ä½¿ç”¨çš„ä¸€å¥—è‡ªå®šä¹‰è¦†å†™è§„åˆ™ï¼ˆYAMLï¼‰ï¼Œå®ç°ã€ŒæŒ‰åœºæ™¯åˆ†æµ + å›½å†…ç›´è¿ + å›½å¤–ä»£ç†ã€çš„ç»Ÿä¸€ç­–ç•¥ã€‚

## æ–‡æ¡£ä¸ºäº†Sparkleçš„windowså®¢æˆ·ç«¯å†™çš„


## æ€è·¯å’Œç»“æ„
ä½¿ç”¨ Clash.Meta å†…æ ¸ï¼Œå€ŸåŠ© Clash Party / Sparkle çš„ã€Œè¦†å†™ YAMLã€åŠŸèƒ½ã€‚
åœ¨ä¸»é…ç½®ä¹‹ä¸Šè¿½åŠ èŠ‚ç‚¹ã€ç­–ç•¥ç»„å’Œè§„åˆ™ï¼Œä¸æ”¹åŠ¨åŸè®¢é˜…çš„èŠ‚ç‚¹å†…å®¹ã€‚
ç›®æ ‡æ˜¯ç»Ÿä¸€å…¥å£ï¼ˆå…¨å±€ä»£ç†è§„åˆ™ï¼‰ï¼ŒæŒ‰åœºæ™¯åˆ†æµï¼ŒåŒæ—¶ä¿è¯å›½å†…ç›´è¿ã€å±€åŸŸç½‘ç›´è¿ã€å›½å¤–èµ°ä»£ç†ã€‚

## çœŸå®èŠ‚ç‚¹ â†’ è‡ªåŠ¨æµ‹é€Ÿç»„ / æ‰‹åŠ¨é€‰æ‹© â†’ å„ä¸šåŠ¡åœºæ™¯ç­–ç•¥ç»„ â†’ æœ€ç»ˆè§„åˆ™å†³ç­–



## åŠŸèƒ½æ¦‚è§ˆ

- ç»Ÿä¸€è®¾ç½®ç«¯å£ã€Tunã€DNS ç­‰å…¨å±€å‚æ•°ï¼Œé€‚é…å¸¸è§æ¡Œé¢ç¯å¢ƒã€‚
- è‡ªåŠ¨è¯†åˆ«å†…ç½‘ IPã€å›½å†…åŸŸå/IP å¹¶ç›´è¿ã€‚
- ä¸ºå¸¸ç”¨æœåŠ¡åˆ›å»ºç‹¬ç«‹ç­–ç•¥ç»„ï¼Œä¾‹å¦‚ï¼š
  - `ğŸ•¹ï¸ Steam`
  - `ğŸ“¹ YouTube`
  - `ğŸ€ Google`
  - `ğŸ¤– AI`
  - `ğŸ‘¨ğŸ¿â€ğŸ’» GitHub`
  - `ğŸ¬ OneDrive`
  - `ğŸªŸ Microsoft`
  - `ğŸµ TikTok`
  - `ğŸ“² Telegram`
  - `ğŸ¥ NETFLIX`
  - `ğŸ’¶ PayPal`
- æŒ‰åœ°åŒºè‡ªåŠ¨æµ‹é€Ÿåˆ†ç»„ï¼š
  - `â™»ï¸ é¦™æ¸¯-è‡ªåŠ¨`ã€`â™»ï¸ æ—¥æœ¬-è‡ªåŠ¨`ã€`â™»ï¸ å°æ¹¾-è‡ªåŠ¨`
  - `â™»ï¸ æ–°åŠ å¡-è‡ªåŠ¨`ã€`â™»ï¸ éŸ©å›½-è‡ªåŠ¨`ã€`â™»ï¸ ç¾å›½-è‡ªåŠ¨`ã€`â™»ï¸ ä¿„ç½—æ–¯-è‡ªåŠ¨`
  - `â™»ï¸ å°æ—¥æ–°éŸ©æ¾³-è‡ªåŠ¨`ã€`â™»ï¸ æ¸¯å°æ—¥æ–°éŸ©æ¾³-è‡ªåŠ¨`
  - `â™»ï¸ ä¸œå—äºš-è‡ªåŠ¨`ã€`â™»ï¸ æ¾³æ´²-è‡ªåŠ¨`
  - `â™»ï¸ æ¬§æ´²-è‡ªåŠ¨`ã€`â™»ï¸ ä¸­ä¸œ-è‡ªåŠ¨`ã€`â™»ï¸ æ‹‰ä¸ç¾æ´²-è‡ªåŠ¨`
  - `ğŸŒ æ‰€æœ‰-è‡ªåŠ¨`ï¼ˆè¿‡æ»¤æ‰ç›´è¿/æ‹’ç»ç±»èŠ‚ç‚¹ï¼‰
- é’ˆå¯¹ `private_ip` / `private_domain` ç­‰è§„åˆ™é›†è‡ªåŠ¨ä½¿ç”¨ `ç›´è¿`ï¼Œé¿å…æœ¬åœ°/å†…ç½‘è®¿é—®èµ°ä»£ç†ã€‚

---

## ä½¿ç”¨ç¯å¢ƒ

- Clash å†…æ ¸ï¼šMeta ç³»åˆ—ï¼ˆå¦‚ Clash.Metaï¼‰
- å®¢æˆ·ç«¯ï¼šClash Party / Sparkle
- è§„åˆ™æ–‡ä»¶ç±»å‹ï¼š**è¦†å†™ YAML**ï¼ˆç”¨äºä¸»é…ç½®è¦†å†™ï¼Œè€Œéè®¢é˜…è¦†å†™ï¼‰

> æ³¨æ„ï¼š  
> æœ¬è§„åˆ™ä½¿ç”¨çš„æ˜¯ **Clash Party çš„è¦†å†™è¯­æ³•**ï¼š  
> - è¿½åŠ èŠ‚ç‚¹ï¼š`+proxies:`  
> - è¿½åŠ ç­–ç•¥ç»„ï¼š`+proxy-groups:`  
> è¯·ä¸è¦å†ä½¿ç”¨ `append-proxies` / `append-proxy-groups` è¿™ç±»å†™æ³•ï¼Œå¦åˆ™åœ¨ Clash Party ä¸­ä¸ä¼šç”Ÿæ•ˆã€‚

---

## éƒ¨ç½²æ­¥éª¤

1. æ‰“å¼€ Clash Party / Sparkle
2. è¿›å…¥ã€Œè¦†å†™ã€æˆ–ã€Œé…ç½®æ¨¡ç‰ˆã€ç¼–è¾‘ç•Œé¢ï¼ˆYAML æ¨¡å¼ï¼‰
3. å°†ä»“åº“ä¸­çš„ YAML å†…å®¹æ•´ä½“ç²˜è´´åˆ°ç¼–è¾‘æ¡†
4. ä¿å­˜é…ç½®
5. åœ¨ä¸»ç•Œé¢é‡è½½ / é‡å¯å†…æ ¸
6. æŸ¥çœ‹æ—¥å¿—æ˜¯å¦å­˜åœ¨é”™è¯¯ï¼ˆç‰¹åˆ«æ˜¯ `proxy [ç›´è¿] not found` è¿™ç±»ï¼‰ï¼Œæ­£å¸¸æƒ…å†µä¸‹ä¸ä¼šå†å‡ºç°ã€‚

---

## è§„åˆ™ç»“æ„è¯´æ˜

### 1. å…¨å±€è®¾ç½®

```yaml
port: 7890
socks-port: 7891
redir-port: 7892
mixed-port: 7893
tproxy-port: 7894
allow-lan: true
bind-address: "*"
ipv6: false
unified-delay: true
tcp-concurrent: true
log-level: warning
```

è®¾ç½® HTTP / SOCKS / Redir / Mixed / TProxy å„ç«¯å£ã€‚
å¯ç”¨ allow-lan ä»¥ä¾¿å±€åŸŸç½‘è®¾å¤‡å…±ç”¨ä»£ç†ã€‚
é™ä½æ—¥å¿—ç­‰çº§ä¸º warningï¼Œå‡å°‘å†—ä½™è¾“å‡ºã€‚


### 2. Tun é…ç½®

```yaml
tun:
  enable: true
  stack: mixed
  dns-hijack: ["any:53", "tcp://any:53"]
  auto-route: true
  auto-redirect: true
  auto-detect-interface: true
```

å¯ç”¨ Tun æ¨¡å¼ï¼Œæ”¯æŒç³»ç»Ÿçº§é€æ˜ä»£ç†ã€‚
dns-hijack å°†ç³»ç»Ÿ DNS è¯·æ±‚æ¥ç®¡åˆ° Clashã€‚

### 3. DNS é…ç½®

```yaml
dns:
  enable: true
  listen: 0.0.0.0:1053
  ipv6: false
  respect-rules: true
  enhanced-mode: fake-ip
  fake-ip-range: 28.0.0.1/8
  fake-ip-filter-mode: blacklist
  fake-ip-filter:
    - "rule-set:private_domain,cn_domain"
    - "+.msftconnecttest.com"
    ...
  default-nameserver:
    - 223.5.5.5
    - 119.29.29.29
  proxy-server-nameserver:
    - 223.5.5.5
    - 119.29.29.29
    - https://223.5.5.5/dns-query
    - https://120.53.53.53/dns-query
    - https://dns.alidns.com/dns-query
    - https://doh.pub/dns-query
```

ä½¿ç”¨ fake-ip æ¨¡å¼ï¼Œæå‡è§£æä¸è¿æ¥æ•ˆç‡ã€‚
fake-ip-filter ä¸­å¯¹ private_domain å’Œ cn_domain ä½¿ç”¨é»‘åå•è¿‡æ»¤ï¼Œé¿å…å›½å†…/ç§æœ‰åŸŸåèµ°å‡ IPã€‚
é»˜è®¤ä¸ä»£ç†ä½¿ç”¨çš„ DNS å‡ä»¥ä¸»æµå›½å†… DoT/DoH ä¸ºä¸»ã€‚

### 4. è¿½åŠ åŸºç¡€èŠ‚ç‚¹

```yaml
+proxies:
  - { name: ç›´è¿, type: direct }
  - { name: æ‹’ç», type: reject }
```

ç›´è¿ï¼šç»Ÿä¸€ç”¨äºè§„åˆ™ä¸­çš„ç›´è¿ç­–ç•¥ï¼Œä¾‹å¦‚ RULE-SET,cn_domain,ç›´è¿ã€‚
æ‹’ç»ï¼šå¯ç”¨äºå±€éƒ¨è§„åˆ™ä¸­æ˜ç¡®æ‹’ç»çš„åœºæ™¯ï¼ˆå½“å‰è§„åˆ™é›†ä¸­æœªç›´æ¥ä½¿ç”¨ï¼Œä¿ç•™ä»¥å¤‡æ‰©å±•ï¼‰ã€‚

### 5. ç­–ç•¥ç»„è®¾è®¡

```yaml
+proxy-groups:
  - {name: ğŸš€ é»˜è®¤ä»£ç†, type: select, proxies: [ç›´è¿, ğŸ‘† æ‰‹åŠ¨é€‰æ‹©èŠ‚ç‚¹, ğŸšŠ IEPLä¸“çº¿, â™»ï¸ é¦™æ¸¯-è‡ªåŠ¨, ... , ğŸŒ æ‰€æœ‰-è‡ªåŠ¨]}
  - {name: ğŸ•¹ï¸ Steam, type: select, proxies: [ç›´è¿, ğŸ‘† æ‰‹åŠ¨é€‰æ‹©èŠ‚ç‚¹, ...]}
  # ... å…¶ä»–ç­–ç•¥ç»„ ...
  - {name: ğŸŸ æ¼ç½‘ä¹‹é±¼, type: select, proxies: [ç›´è¿, ğŸ‘† æ‰‹åŠ¨é€‰æ‹©èŠ‚ç‚¹, ...]}

  - {name: ğŸ‘† æ‰‹åŠ¨é€‰æ‹©èŠ‚ç‚¹, type: select, include-all: true}
  - {name: ğŸšŠ IEPLä¸“çº¿, type: select, include-all: true, filter: "IEPL"}

  - {name: â™»ï¸ é¦™æ¸¯-è‡ªåŠ¨, type: url-test, include-all: true, ... , filter: "é¦™æ¸¯-"}
  # ... å…¶ä»–è‡ªåŠ¨ç»„ ...
  - name: ğŸŒ æ‰€æœ‰-è‡ªåŠ¨
    type: url-test
    include-all: true
    # ...
    filter: "^(?!.*(ç›´è¿|DIRECT|REJECT|æ‹’ç»)).*$"
```

æ‰€æœ‰ä¸šåŠ¡åœºæ™¯ï¼ˆYouTube / AI / GitHub ç­‰ï¼‰éƒ½æŒ‡å‘ä¸€ä¸ª select ç­–ç•¥ç»„ï¼Œé»˜è®¤å€™é€‰é¡¹åŒ…æ‹¬ï¼š
ç›´è¿ï¼ˆç”¨äºå°‘æ•°å›½å†… / ä¸éœ€è¦ç¿»å¢™åœºæ™¯ï¼‰
ğŸ‘† æ‰‹åŠ¨é€‰æ‹©èŠ‚ç‚¹ï¼ˆåªåˆ—å‡ºæ‰€æœ‰èŠ‚ç‚¹ä¾›æ‰‹åŠ¨æŒ‘é€‰ï¼‰
å„åœ°åŒºçš„è‡ªåŠ¨æµ‹é€Ÿç»„
å„åœ°åŒºè‡ªåŠ¨ç»„ (url-test) ä¼šå®šæ—¶æµ‹é€Ÿï¼Œå¹¶è‡ªåŠ¨é€‰æ‹©å»¶è¿Ÿæœ€ä½çš„èŠ‚ç‚¹ã€‚
ğŸŒ æ‰€æœ‰-è‡ªåŠ¨ ä½¿ç”¨æ­£åˆ™æ’é™¤ ç›´è¿ / DIRECT / REJECT / æ‹’ç»ï¼Œä»…åœ¨å‰©ä½™ä»£ç†èŠ‚ç‚¹ä¸­æµ‹é€Ÿé€‰æ‹©ã€‚

### 6. è§„åˆ™ï¼ˆRulesï¼‰

```yaml
rules:
  - RULE-SET,private_ip,ç›´è¿
  - RULE-SET,private_domain,ç›´è¿
  - RULE-SET,steamcn_domain,ç›´è¿
  - RULE-SET,steam_domain,ğŸ•¹ï¸ Steam
  - DOMAIN-SUFFIX,qichiyu.com,ğŸš€ é»˜è®¤ä»£ç†
  - RULE-SET,proxylite,ğŸš€ é»˜è®¤ä»£ç†
  - RULE-SET,ai,ğŸ¤– AI
  - RULE-SET,github_domain,ğŸ‘¨ğŸ¿â€ğŸ’» GitHub
  - RULE-SET,youtube_domain,ğŸ“¹ YouTube
  - RULE-SET,google_domain,ğŸ€ Google
  - RULE-SET,onedrive_domain,ğŸ¬ OneDrive
  - RULE-SET,microsoft_domain,ğŸªŸ Microsoft
  - RULE-SET,apple_domain,ç›´è¿
  - RULE-SET,tiktok_domain,ğŸµ TikTok
  - RULE-SET,telegram_domain,ğŸ“² Telegram
  - RULE-SET,netflix_domain,ğŸ¥ NETFLIX
  - RULE-SET,paypal_domain,ğŸ’¶ PayPal
  - RULE-SET,apple_ip,ç›´è¿,no-resolve
  - RULE-SET,google_ip,ğŸ€ Google,no-resolve
  - RULE-SET,netflix_ip,ğŸ¥ NETFLIX,no-resolve
  - RULE-SET,telegram_ip,ğŸ“² Telegram,no-resolve
  - RULE-SET,geolocation-!cn,ğŸš€ é»˜è®¤ä»£ç†
  - RULE-SET,cn_domain,ç›´è¿
  - RULE-SET,cn_ip,ç›´è¿
  - MATCH,ğŸŸ æ¼ç½‘ä¹‹é±¼
```

private_ip / private_domain / steamcn_domain ç­‰ç§æœ‰æˆ–å›½åŒºå†…å®¹å…¨éƒ¨ç›´è¿ã€‚
å„å¤§æœåŠ¡ï¼ˆSteamã€YouTubeã€Googleã€AIã€GitHubã€OneDriveã€Microsoftã€Appleã€TikTokã€Telegramã€Netflixã€PayPalï¼‰æŒ‰ç…§åˆ†ç±»è·¯ç”±åˆ°å¯¹åº”ç­–ç•¥ç»„ã€‚
é€šè¿‡ geolocation-!cn æŠŠæµ·å¤– IP æŒ‡å‘ ğŸš€ é»˜è®¤ä»£ç†ã€‚
å›½å†…åŸŸå / IP (cn_domain, cn_ip) æœ€ç»ˆç›´è¿ã€‚
MATCH,ğŸŸ æ¼ç½‘ä¹‹é±¼ æ•è·æ‰€æœ‰æœªè¢«å‰é¢è§„åˆ™å‘½ä¸­çš„æµé‡ï¼Œäº¤ç»™ ğŸŸ æ¼ç½‘ä¹‹é±¼ æ‰‹åŠ¨/è‡ªåŠ¨å†³å®šå»å‘ã€‚

### 7. è§„åˆ™é›†ï¼ˆRule Providersï¼‰

```yaml
rule-anchor:
  ip:     &ip     {type: http, interval: 86400, behavior: ipcidr,    format: mrs}
  domain: &domain {type: http, interval: 86400, behavior: domain,    format: mrs}
  class:  &class  {type: http, interval: 86400, behavior: classical, format: text}

rule-providers:
  private_domain:   { <<: *domain, url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/private.mrs"}
  steam_domain:     { <<: *domain, url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/steam.mrs"}
  steamcn_domain:   { <<: *domain, url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/steam@cn.mrs"}
  proxylite:        { <<: *class,  url: "https://raw.githubusercontent.com/qichiyuhub/rule/refs/heads/main/proxy.list"}
  ai:               { <<: *domain, url: "https://github.com/MetaCubeX/meta-rules-dat/raw/refs/heads/meta/geo/geosite/category-ai-!cn.mrs"}
  youtube_domain:   { <<: *domain, url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/youtube.mrs"}
  google_domain:    { <<: *domain, url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/google.mrs"}
  github_domain:    { <<: *domain, url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/github.mrs"}
  telegram_domain:  { <<: *domain, url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/telegram.mrs"}
  netflix_domain:   { <<: *domain, url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/netflix.mrs"}
  paypal_domain:    { <<: *domain, url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/paypal.mrs"}
  onedrive_domain:  { <<: *domain, url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/onedrive.mrs"}
  microsoft_domain: { <<: *domain, url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/microsoft.mrs"}
  apple_domain:     { <<: *domain, url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/apple-cn.mrs"}
  speedtest_domain: { <<: *domain, url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/ookla-speedtest.mrs"}
  tiktok_domain:    { <<: *domain, url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/tiktok.mrs"}
  geolocation-!cn:  { <<: *domain, url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/geolocation-!cn.mrs"}
  cn_domain:        { <<: *domain, url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/cn.mrs"}

  private_ip:  { <<: *ip, url: "https://github.com/MetaCubeX/meta-rules-dat/raw/refs/heads/meta/geo/geoip/private.mrs"}
  cn_ip:       { <<: *ip, url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geoip/cn.mrs"}
  google_ip:   { <<: *ip, url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geoip/google.mrs"}
  telegram_ip: { <<: *ip, url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geoip/telegram.mrs"}
  netflix_ip:  { <<: *ip, url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geoip/netflix.mrs"}
  apple_ip:    { <<: *ip, url: "https://github.com/MetaCubeX/meta-rules-dat/raw/refs/heads/meta/geo-lite/geoip/apple.mrs"}
```

ä½¿ç”¨ rule-anchor å®šä¹‰ä¸‰ç§ Anchorï¼ˆIPã€åŸŸåã€classical æ–‡æœ¬ï¼‰ï¼Œé¿å…é‡å¤é…ç½®å­—æ®µã€‚
å¤§éƒ¨åˆ†è§„åˆ™é›†æ¥æºäº MetaCubeX/meta-rules-datï¼Œè‡ªåŠ¨æŒ‰æ—¥æ›´æ–°ï¼ˆinterval: 86400 ç§’ï¼‰ã€‚
proxylite ä¸ºè‡ªå®šä¹‰æ–‡æœ¬è§„åˆ™é›†ï¼Œå¯ä»¥é…åˆ RULE-SET,proxylite,ğŸš€ é»˜è®¤ä»£ç† ä½¿ç”¨ã€‚















